# Cyprus - Jeankedezeehond

add_namespace = cyprus_events

######################
# GREAT GREEK REVOLT #
######################

country_event = {	#Cyprus joins the revolt
	id = cyprus_events.1
	immediate = {
		log = "KR_Event_Logging;Cyprus REVOLTS AGAINST OTT"
	}
	title = cyprus_events.1.t
	desc = cyprus_events.1.d

	picture = GFX_OTT_Barzani_Revolt

	trigger = {
		has_war_with = EGY
		183 = { is_owned_and_controlled_by = ROOT } #Cyprus
		GRE = {
			exists = yes
			is_subject = no
			NOT = { has_completed_focus = GRE_turkish_thaw }
		}
	}

	fire_only_once = yes

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			183 = { teleport_armies = { limit = { is_ally_with = ROOT } } }
			CYP = {
				add_state_core = 183
				add_state_core = 164
				add_state_core = 187
				transfer_state = 183
				division_template = {
					name = "Merarchia Pezikou"
					division_names_group = GRE_INF_01
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
						infantry = { x = 0 y = 2 }
						infantry = { x = 1 y = 0 }
						infantry = { x = 1 y = 1 }
						infantry = { x = 1 y = 2 }
						infantry = { x = 2 y = 0 }
						infantry = { x = 2 y = 1 }
						infantry = { x = 2 y = 2 }
					}
				}
				division_template = {
					name = "Merarchia Ippikou"
					is_locked = yes
					division_names_group = GRE_CAV_01
					regiments = {
						cavalry = { x = 0 y = 0 }
						cavalry = { x = 0 y = 1 }
						cavalry = { x = 0 y = 2 }
						cavalry = { x = 1 y = 0 }
						cavalry = { x = 1 y = 1 }
						cavalry = { x = 1 y = 2 }
					}
				}
				183 = { #Cyprus
					create_unit = {
						division = "division_template = \"Merarchia Pezikou\" start_experience_factor = 0.1 start_equipment_factor = 0.9"
						allow_spawning_on_enemy_provs = yes
						prioritize_location = 11984
						owner = PREV
					}
				}
				declare_war_on = {
					target = OTT
					type = annex_everything
				}
				add_offsite_building = {
					type = arms_factory
					level = 2
				}
				country_event = { id = cyprus_events.7 days = 3 }
			}
			random_other_country = {
				limit = {
					has_character = GRE_georgios_grivas
					is_subject = no
				}
				GRE_georgios_grivas = { unit_leader_event = cyprus_events.5 }
			}
			news_event = { id = levant_crisis_news.3 days = 1 }
		}
	}

	option = {
		log = "[GetLogInfo]: event cyprus_events.1 option cyprus_events.1.a"
		name = cyprus_events.1.a
		custom_effect_tooltip = ott_gre_spread
		every_state = {
			limit = {
				is_core_of = CYP
			}
			ott_increase_revolt_risk = yes
		}
	}
}

country_event = {	#Rhodos joins the revolt
	id = cyprus_events.2
	title = cyprus_events.2.t
	desc = cyprus_events.2.d

	trigger = {
		is_subject = no
		has_war_with = CYP
		164 = { is_owned_and_controlled_by = ROOT } #Dodecanese
	}

	fire_only_once = yes

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			164 = {
				teleport_armies = { limit = { is_ally_with = ROOT } }
				transfer_state_to = CYP
				create_unit = {
					division = "name = \"Greek Rebels\" division_template = \"Merarchia Ippikou\" start_experience_factor = 0.1"
					owner = CYP
					prioritize_location = 10007
					allow_spawning_on_enemy_provs = yes
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event cyprus_events.2 option cyprus_events.2.a"
		name = cyprus_events.2.a
		custom_effect_tooltip = ott_gre_spread
	}
}

country_event = {	#Lesbos joins the revolt
	id = cyprus_events.3
	title = cyprus_events.3.t
	desc = cyprus_events.3.d

	trigger = {
		is_subject = no
		has_war_with = CYP
		187 = { is_owned_and_controlled_by = ROOT } #Aegean Islands
	}

	is_triggered_only = yes
	fire_only_once = yes

	immediate = {
		hidden_effect = {
			187 = {
				teleport_armies = { limit = { is_ally_with = ROOT } }
				transfer_state_to = CYP
				create_unit = {
					division = "name = \"Greek Rebels\" division_template = \"Merarchia Ippikou\" start_experience_factor = 0.1"
					owner = CYP
					prioritize_location = 6550
					allow_spawning_on_enemy_provs = yes
				}
			}
		}
	}

	option = {
		log = "[GetLogInfo]: event cyprus_events.3 option cyprus_events.2.a"
		name = cyprus_events.2.a
		custom_effect_tooltip = ott_gre_spread
	}
}

country_event = { #Colonel George Grivas returns from Cyprus
	id = cyprus_events.4
	title = cyprus_events.4.t
	desc = cyprus_events.4.d

	trigger = {
		CYP = { has_character = GRE_georgios_grivas }
		has_socialist_government = no
	}

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.4 option cyprus_events.4.a"
		name = cyprus_events.4.a
		CYP = {
			GRE_georgios_grivas = {
				set_nationality = ROOT
				demote_to_general = yes
			}
		}
	}
}

unit_leader_event = { #Colonel George Grivas leaves for Cyprus
	id = cyprus_events.5
	title = cyprus_events.5.t
	desc = cyprus_events.5.d

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.5 option cyprus_events.5.a"
		name = cyprus_events.5.a
		GRE_georgios_grivas = {
			set_nationality = CYP
			hidden_effect = { unit_leader_event = { id = cyprus_events.6 days = 2 } }
		}
	}
}

unit_leader_event = {	#Colonel George Grivas arrives on Cyprus
	id = cyprus_events.6
	title = cyprus_events.6.t
	desc = cyprus_events.6.d

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.6 option cyprus_events.5.a"
		name = cyprus_events.5.a
		ROOT = { add_war_support = 0.05 }
	}
}

country_event = {	#Freedom at last
	id = cyprus_events.7
	title = cyprus_events.7.t
	desc = cyprus_events.7.d

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.7 option cyprus_events.7.a"
		name = cyprus_events.7.a
		add_stability = 0.10
		GRE = {
			if = {
				limit = {
					is_in_faction = no
					is_subject = no
					can_declare_war_on = OTT
				}
				country_event = { id = cyprus_events.8 days = 3 }
			}
		}
	}
}

country_event = {	#Cyprus demands Enosis
	id = cyprus_events.8
	title = cyprus_events.8.t
	desc = cyprus_events.8.d
	picture = GFX_report_event_GRE_athens

	is_triggered_only = yes

	trigger = {
		has_capitulated = no
		has_civil_war = no
	}

	option = {
		log = "[GetLogInfo]: event cyprus_events.8 option cyprus_events.8.a"
		name = cyprus_events.8.a
		trigger = {
			is_in_faction = no
			is_subject = no
			can_declare_war_on = OTT
		}
		ai_chance = {
			base = 10
			modifier = {
				factor = 10
				CYP = { is_ai = no }
			}
			modifier = {
				factor = 2
				has_war = no
			}
			modifier = {
				factor = 0.1
				has_war = yes
			}
			modifier = {
				factor = 10
				OTT = {
					surrender_progress > 0.4
				}
			}
			modifier = {
				factor = 5
				OTT = {
					has_war_with = SYR
					has_war_with = HEJ
					has_war_with = EGY
				}
			}
			modifier = {
				factor = 2
				OTT = {
					has_war_with = PER
				}
			}
		}
		add_to_array = { GRE_megali_enemies = OTT }
		CYP = { country_event = cyprus_events.9 }
		declare_war_on = {
			target = OTT
			type = annex_everything
		}
		add_war_support = -0.20
		set_temp_variable = { target = CYP }
		puppet_country_without_changing_government = yes
	}
	option = {
		log = "[GetLogInfo]: event cyprus_events.8 option cyprus_events.8.b"
		name = cyprus_events.8.b
		trigger = { has_manpower > 20000 }
		ai_chance = {
			base = 90
			modifier = {
				factor = 10
				has_war = yes
			}
		}
		CYP = { country_event = cyprus_events.10 }
		add_manpower = -20000
		add_ideas = CYP_revolt_support
	}
	option = {
		log = "[GetLogInfo]: event cyprus_events.8 option cyprus_events.8.c"
		name = cyprus_events.8.c
		ai_chance = {
			base = 0
			modifier = {
				add = 10
				NOT = { has_manpower > 20000 }
			}
		}
		CYP = {
			country_event = cyprus_events.11
		}
		add_stability = -0.15
	}
}

country_event = {	#Greece joins the war
	id = cyprus_events.9
	title = cyprus_events.9.t
	desc = cyprus_events.9.d
	picture = GFX_report_event_GRE_athens

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.9 option cyprus_events.9.a"
		name = cyprus_events.9.a
		add_war_support = 0.20
		if = {
			limit = { is_ai = no }
			GRE = { change_tag_from = CYP }
		}
	}
}

country_event = {	#Greece sends aid
	id = cyprus_events.10
	title = cyprus_events.10.t
	desc = cyprus_events.10.d
	picture = GFX_report_event_GRE_athens

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.10 option cyprus_events.10.a"
		name = cyprus_events.10.a
		add_war_support = 0.10
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 3000
		}
		add_offsite_building = {
			type = arms_factory
			level = 1
		}
		add_manpower = 20000
		army_experience = 50
		swap_ideas = {
			remove_idea = CYP_revolt
			add_idea = CYP_revolt2
		}
	}
}

country_event = {	#Greece refuses to intervene
	id = cyprus_events.11
	title = cyprus_events.11.t
	desc = cyprus_events.11.d
	picture = GFX_report_event_GRE_athens

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event cyprus_events.11 option cyprus_events.11.a"
		name = cyprus_events.11.a
		add_war_support = -1
		remove_ideas = CYP_revolt
		add_ideas = CYP_revolt_no_support
	}
}

country_event = {	#End of Cyprus
	id = cyprus_events.14
	title = cyprus_events.14.t
	desc = cyprus_events.14.d
	picture = GFX_report_event_GRE_athens

	trigger = {
		original_tag = GRE
		country_exists = CYP
		CYP = {
			NOT = {
				has_war_with = TUR
				has_war_with = ROOT
			}
			has_full_control_of_state = 183
			OR = {
				is_subject = no
				is_subject_of = ROOT
			}
			OR = {
				is_in_faction = no
				is_in_faction_with = ROOT
			}
			is_ai = yes
		}
		has_capitulated = no
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 5
	}

	option = {
		log = "[GetLogInfo]: event cyprus_events.14 option cyprus_events.14.a"
		name = cyprus_events.14.a
		CYP = {
			if = {
				limit = { has_character = GRE_georgios_grivas }
				GRE_georgios_grivas = {
					set_nationality = ROOT
					demote_to_general = yes
				}
			}
			if = {
				limit = { has_character = CYP_ioannis_tsangaridis }
				CYP_ioannis_tsangaridis = {
					set_nationality = ROOT
					demote_to_general = yes
				}
			}
		}
		annex_country = {
			target = CYP
			transfer_troops = no
		}
	}
}

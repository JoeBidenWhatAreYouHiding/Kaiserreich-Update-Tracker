###########################
# Transylvania Events
# By wyandotte and Alpinia
###########################

add_namespace = transylvania_events

# Ask to join Romania
country_event = {
	id = transylvania_events.1
	title = transylvania_events.1.t
	desc = transylvania_events.1.d
	picture = GFX_report_event_spain_civil_war_soldiers

	trigger = {
		tag = TRS
		has_war = no
		country_exists = ROM
		NOT = { has_war_with = ROM }
		NOT = { has_autonomy_state = crownland }
		if = {
			limit = { is_subject = yes }
			ROM = {
				OR = {
					is_subject_of = ROOT.overlord
					AND = {
						is_in_faction_with = ROOT.overlord
						var:ROOT.overlord = { is_faction_leader = yes }
					}
				}
				has_capitulated = no
			}
		}
		else = {
			ROM = {
				is_subject = no
				has_capitulated = no
			}
		}
		81 = { is_demilitarized_zone = no }
	}

	fire_only_once = yes

	mean_time_to_happen = {
		days = 3
	}

	option = {
		log = "[GetLogInfo]: event transylvania_events.1 option transylvania_events.1.a"
		name = transylvania_events.1.a # Ask for a Union
		trigger = { is_subject = no }
		ROM = { country_event = { id = transylvania_events.2 hours = 8 } }
	}

	option = {
		log = "[GetLogInfo]: event transylvania_events.1 option transylvania_events.1.b"
		name = transylvania_events.1.b # Ask overlord to allow Union
		trigger = { is_subject = yes }
		overlord = { country_event = { id = transylvania_events.3 hours = 8 } }
	}

	option = {
		log = "[GetLogInfo]: event transylvania_events.1 option transylvania_events.1.c"
		name = transylvania_events.1.c # Don't ask
		ai_chance = { base = 0 }
		add_political_power = -100
	}
}

# Romania: Transylvania wants to join us
country_event = {
	id = transylvania_events.2
	title = transylvania_events.2.t
	desc = transylvania_events.2.d
	picture = GFX_report_event_spain_civil_war_soldiers

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event transylvania_events.2 option transylvania_events.2.a"
		name = transylvania_events.2.a
		annex_country = {
			target = FROM
			transfer_troops = yes
		}
	}
}

# Overlord of ROM and TRS: Transylvania wishes to unite with Romania
country_event = {
	id = transylvania_events.3
	title = transylvania_events.3.t
	desc = transylvania_events.3.d
	picture = GFX_report_event_spain_civil_war_soldiers

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event transylvania_events.3 option transylvania_events.3.a"
		name = transylvania_events.3.a
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				OR = {
					tag = AUS
					tag = BUL
					tag = HUN
				}
				any_owned_state = {
					OR = {
						is_core_of = ROM
						is_claimed_by = ROM
					}
				}
			}
		}
		FROM = { country_event = { id = transylvania_events.4 hours = 8 } }
	}

	option = {
		log = "[GetLogInfo]: event transylvania_events.3 option transylvania_events.3.b"
		name = transylvania_events.3.b
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					tag = AUS
					tag = BUL
					tag = HUN
				}
				any_owned_state = {
					OR = {
						is_core_of = ROM
						is_claimed_by = ROM
					}
				}
			}
		}
		FROM = { country_event = { id = transylvania_events.5 hours = 8 } }
	}
}

# Transylvania: Overlord approves union
country_event = {
	id = transylvania_events.4
	title = transylvania_events.4.t
	desc = transylvania_events.4.d
	picture = GFX_report_event_spain_civil_war_soldiers

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event transylvania_events.4 option transylvania_events.4.a"
		name = transylvania_events.4.a
		ROM = { country_event = { id = transylvania_events.2 hours = 8 } }
	}
}

# Transylvania: Overlord denies union
country_event = {
	id = transylvania_events.5
	title = transylvania_events.5.t
	desc = transylvania_events.5.d
	picture = GFX_report_event_spain_civil_war_soldiers

	is_triggered_only = yes

	option = {
		log = "[GetLogInfo]: event transylvania_events.5 option transylvania_events.5.a"
		name = transylvania_events.5.a
		reverse_add_opinion_modifier = { target = FROM modifier = KR_hates_govt }
	}
}
